{% extends "navbar.html" %}

{% block title %}
Car Parking System | View Tiers
{% endblock %}

{% block content%}
<p class="h1">Membership Tiers</p>
<button class="btn btn-secondary mb-3" onclick=""><i class="bi bi-plus"></i> Add</button>
<div class="row mb-3">
    <div class="col">
        <table class="table" id="member_table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Tier Name</th>
                    <th>Discount</th>
                    <th>Price</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                {% if tier_data: %}
                {% for row in tier_data: %}
                <tr>
                    <td class="align-middle">{{ row[0] }}</td>
                    <td class="align-middle">{{ row[1] }}</td>
                    <td class="align-middle">{{ row[3] }}%</td>
                    <td class="align-middle">{{ row[2] }}</td>
                    <td>
                        <a href="" class="btn btn-secondary"><i class="bi bi-pencil-square"></i></a>
                        <a href="" class="btn btn-danger"><i class="bi bi-trash-fill"></i></a>
                    </td>
                </tr>
                {% endfor %}
                {% endif %}
            </tbody>
        </table>
    </div>
    <div class="col" hidden>
        <p class="h4">Edit Tier</p>
        <div class="mb-3">
            <label for="tierId" class="form-label">ID</label>
            <input type="text" class="form-control" name="tierId" id="tierId" readonly>
        </div>
        <form action="" method="post">
            <div class="mb-3">
                <label for="tierName" class="form-label">Name</label>
                <input type="text" class="form-control" name="tierName" id="tierName" placeholder="" required>
            </div>

            <div class="mb-3">
                <label for="discount" class="form-label">Discount</label>
                <input type="text" class="form-control" name="discount" id="discount" placeholder="" required>
            </div>
            <div class="mb-3">
                <label for="price" class="form-label">Price</label>
                <input type="text" class="form-control" name="price" id="price" placeholder="" required>
            </div>
            <div class="row">
                <div class="col-3 d-grid">
                    <input type="submit" class="btn btn-primary" value="Update">
                </div>
                <!-- <div class="col-3 d-grid">
                    <input type="reset" class="btn btn-warning" value="Reset">
                </div> -->
            </div>

        </form>
    </div>
</div>

<script>
    $(document).ready(function () {
        $('#member_table').DataTable({
            "scrollY": "70vh",
            "scrollCollapse": true,
            "paging": false
        });

        var selectTierId = document.getElementById("selectTierId")
        var tierName = document.getElementById("tierName")
        var discount = document.getElementById("discount")
        var price = document.getElementById("price")
        selectTierId.onchange = function () {
            if (this.value != "") {
                $.get(`/get-tiers/${this.value}`, function (data) {
                    tierName.value = data[1]
                    discount.value = data[3]
                    price.value = data[2]
                })
            }

        }

    });
</script>


{% endblock%}